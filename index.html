<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Music Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://kit.fontawesome.com/d2549c76b2.js" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>

<body>
  <div class="main-container">
    <div class="music-container">
      <h2 id="title">Empire Seasons </h2>
      <p id="artist">Dan Heigh</p>
      <div class="image-container">
        <img src="images/tarun.jpg" alt="">
      </div>
      <audio src="music/tarun.mp3">
      </audio>

      <!-- progress bar -->
      <div class="progressbar-container" id="progress-container">
        <div class="progress-duration-meter">
          <div class="current-time" id="currentTime"> 0:00 </div>
          <div class="duration"id="durationTime">2:44</div>
        </div>
        <div class="progress-div" id="progress-div">
          <div class="progress" id="progress" > </div>
        </div>

      </div>

      <!-- controls -->
      <div class="music-controls">
        <i class="fas fa-backward" id="prev" title="Previous"></i>
        <i class="fas fa-play main-button" id="play" title="Play"></i>
        <i class="fas fa-forward" id="next" title="Next"></i>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    const music = document.querySelector("audio");
    const image = document.querySelector("img");
    const play = document.getElementById('play');
    const prev = document.getElementById('prev');
    const next = document.getElementById('next');
    const title = document.getElementById('title');
    const artist = document.getElementById('artist');
    const progress_div=document.getElementById("progress-div")

    const songs =[
      {
      name:"tarun",
      title:"Empire Seasons",
      artist:"Dan Heigh",
    },
    {
    name:"tarun-1",
    title:"Eternal Garden",
    artist:"Dan Heigh",
  },
  {
  name:"tarun-2",
  title:"Ana Captainslogu",
  artist:"Noir Et Blac",
},
];

    let isPlaying = false;
    // for play
    const playMusic = () => {
      isPlaying = true;
      music.play();
      play.classList.replace("fa-play", "fa-pause");
      image.classList.add("anime");

    };
    // for pause
    const pauseMusic = () => {
      isPlaying = false;
      music.pause();
      play.classList.replace("fa-pause", "fa-play");
      image.classList.remove("anime");

    };

    play.addEventListener("click", function() {
      // if(isPlaying==true){
      //   pauseMusic();
      // }else{
      //   playMusic();
      // }
      isPlaying ? pauseMusic() : playMusic();
    });

    // chnaging song data
const loadSong=(songs) => {
title.textContent=songs.title;
artist.textContent=songs.artist;
image.src="images/" + songs.name + ".jpg";
music.src="music/" + songs.name + ".mp3";
};
    // loadSong(songs[1]);
songIndex=0;
const nextSong=()=>{
  songIndex=(songIndex+1)%songs.length;
  loadSong(songs[songIndex]);
  playMusic();
}
const prevSong=()=>{
  // first method to go back (songIndex-1+songs.length)
  songIndex=(songIndex-1+songs.length)%songs.length;
  // second method to go back remove +songs.length and follow the step
  // if(songIndex<0){
  //   songIndex=songs.length-1;
  // }
  loadSong(songs[songIndex]);
    playMusic();
}

// progress bar

const durationTime=document.getElementById("durationTime");
const current=document.getElementById("currentTime");
const progress=document.getElementById("progress");

music.addEventListener('timeupdate', (event) => {
  // console.log(event);
// duration meter current time and total time
const currentTime=music.currentTime;
const duration=music.duration;
// for duration time
   // console.log(currentTime);
   // console.log(duration);
  const durationMin=Math.floor(duration/60);
  const durationSec=Math.floor(duration%60);


  // console.log(durationSec);
  // console.log(durationMin);
  if(duration){
    durationTime.textContent=durationMin+":"+durationSec;
  }







// for currentTime
const currentMin=Math.floor(currentTime/60);
let currentSec=Math.floor(currentTime%60);
// console.log(currentMin);
// console.log(currentSec);

if(currentSec<10){
  currentSec="0"+currentSec;
}
let current_time=currentMin+":"+currentSec;
current.textContent=currentMin+":"+currentSec;
 // going to next song



  // for progress bar width
   const progressTime=(currentTime/duration)*100;
   // console.log(progressTime);
   progress.style.width=`${progressTime}%`;

});
// changing the song time by clicking on the progress bar
progress_div.addEventListener("click",function(event){
  console.log(event);

  console.log(music.duration);
  console.log(music.currentTime);
  const duration=music.duration;
  let clickedTime=(event.offsetX/event.srcElement.clientWidth)*duration;
  console.log(clickedTime);
  music.currentTime=clickedTime;
})



    // when the song is ended going to next song
    music.addEventListener("ended",nextSong);

    next.addEventListener("click",nextSong);
    prev.addEventListener("click",prevSong);
  </script>
</body>

</html>
